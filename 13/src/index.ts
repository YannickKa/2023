//--------------- Input section ----------------------//
const testInput = `#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#`.split("\n\n");

const realInput = `##..#..#......#
.........#..#..
.####.#.######.
#....#.###..###
..##..#.#.##.#.
######...#..#..
#.##.#.#.#..#.#
#....#..######.
.#..#...#.##.#.
#....#....##...
.#..#.#..####..
......#.######.
##..##.#.####.#

.#...##..
..##.#.##
.#.###...
###..#.##
##.#.####
..#.#..##
.###...##
.#...#.##
#####.#..
...#..###
###.##.##
####...##
####..###
###.##.##
...#..###

#####...####.#.
##..###..#..#.#
...#.###.....#.
...#.###.....#.
##..###..#..#.#
#####...####.#.
##....####.....
#..##.....#..#.
#..##.....#..#.
##....####.....
#####...######.
##..###..#..#.#
...#.###.....#.

#..##...#
#..#..###
#..#..###
#..##...#
.##..#.#.
.....###.
#..#.##.#
...#..###
.##.#..##
.##.#.#.#
#####.#..

######.#.#.#...
.#..#.#.##...#.
...#....#.#.#..
#.##.#.#.....#.
.......##.#.###
#######.##.#..#
......##...##..
#.##.#....#.#..
#.##.#....#.#..

#...#..##..
.##..######
....###..##
.#..#..##..
.####.####.
###.##....#
.#..##...##
###.#..##..
#.#.#......
.####......
....#.####.
..##..#..#.
..#.#.####.
..#.#.####.
..##..#..#.

#...#.#.##.#.#...
###.#..#..#..#.##
#...##.####.##...
#.....#.##.#.....
...#####..#####..
##..#.######.#..#
###.##.#..#.##.##
...#..#.##.#..#..
....#........#...
#..##.#.##.#.##..
#................

...##.###.#
...##.###.#
##..#....#.
##.....#.##
#.##..#.#.#
..##...#.#.
...#####..#

.##.##.#.##..
#..#.#.#.....
####.###..#.#
####.####.###
#..#.#####.##
#..#.#....###
#..#.#....###
#..#.#####.##
####.####.###
####..##..#.#
#..#.#.#.....
.##.##.#.##..
.....##.#.#..
####..#.#.##.
#####.#...###
#####.#...#..
#..#...####.#

#..#.#...#...##..
...#...#..#..##..
#..####.#.#.####.
..#####..#.##..##
..#...####.##...#
.#.#########....#
.#.#########....#

#..#...#.#.#...#.
#.####...###.#.#.
#.....##...##.#.#
##.##....#....#..
#.....##....#....
..##.##.#...#..#.
..##.##.#...#..#.
#.....##....#....
##.##....#....#..
#.....##...##.#.#
#.####...###.#.#.
#..#...#.###...#.
......#.#..##....
......#.#..##....
#..#...#.###...#.
#.####...###.#.#.
#.....##...##.#.#

....#..
#.##...
#.###..
#...##.
.##..##
.##..##
#...##.
#.###..
#.##...

##.##.#..
..#..#..#
...#####.
..#....##
##.##.##.
##.##.##.
..#...###
...#####.
..#..#..#

...####.....#####
.#......#.####..#
.#########.##....
####..#####.#####
..######..#...##.
#.##..##.#....##.
....##....##.....
#........#.#.....
....##.....#.....
...#..#.......##.
#.######.##......
.##....##.###.##.
...####...#..#..#

.#...###..###...#
##..##.#....##..#
.#.#.########.#.#
.######.##.######
.##.#...##...#.##
.#...########...#
.#.#...#..#...#.#
#..#....##....#..
#..####.##.####..
#.##..##..##..##.
..#...#.##.#...#.
#..#..........#..
#..#..........#..

....#..###....#
#..#..#..#....#
#..##.....####.
.##..#..#..##..
####.###..####.
###.#.##.#.##.#
.##..#..##....#
#####.###..##..
####..#...#..#.
#..#....#..##..
#..####..##..##
......#.##.##.#
.##...#########
.........#.##.#
.##..######..##
#..####..#....#
.##.####..#..#.

#..#.##...#.##.
###.##.##.#...#
##.########.#.#
.#.#.##.#...###
.#.#....####...
.#.#....####...
.#.#.##.#...###
##.########.#.#
###.#..##.#...#
#..#.##...#.##.
#..#.##...#.##.

.##..####..##..
####..##..#####
.#.#.####.#.#..
..##..##..##...
#....#####...##
####.#..#.#####
##..........###
#.#.#....#.#.##
#...##..##...##
.##.##..##.##..
..##..##..##...
....#.##.#.....
###.######.####

########..#.##.#.
######..######.##
#.##.#.#.###.###.
#....#.#.####.###
#....##..#..###..
......##.##..###.
..##..#..#.###..#
..##..#.#.##...#.
##..######..##..#
##..######...#..#
..##..#.#.##...#.
..##..#..#.###..#
......##.##..###.
#....##..#..###..
#....#.#.####.###
#.##.#.#.###.###.
######..######.##

#.####..##..#
#.#.#........
.#.###...#..#
#...#..##....
...#.#.###..#
#..####.#....
#####.#..#..#
.##..####....
.....#...#..#
##.#...#.####
.....###.....
###..##.#....
.#..##.#.####
#...#..#..##.
##...#.......
.#...#.......
#...#..#..##.

...#..##.
..#.#.#.#
######.##
#####.###
..####...
######..#
######..#
..####...
#####.###
######.##
..#.#.#.#
...#..##.
#..###.##
####..##.
...#.#..#
...###.#.
..##.##.#

.####.....#.#
........#.###
##..##...##.#
..##...####..
..##...####..
##..##...##.#
........#.###
.####.....#.#
######.##.#..
.#..#.####.#.
##..####.##.#
#.##.##..#...
##..########.
##..##.##.#.#
.####....#.#.
.....#.#.#.#.
.#..#....#.##

#..########..##
#............##
#.##########.##
.#.#.####.#.#..
##.#......#.###
.#.###..#.#.#..
###.######.####
#.##.####.##.##
##.##....##.###
#.#.#.##.#.#.##
#.##......##.##

.#......#..####.#
#.#.#####.#.###..
##..##.#..#...##.
.##.#..###...#..#
.##.#..###...#..#
##..##.#..#...##.
#.#.#####.#.###..
.#......#..####.#
#..##.#.##..#.#..
#..##.#.##..#.#..
.#.....##..####.#
#.#.#####.#.###..
##..##.#..#...##.

.#....#......#.
..#.##.######.#
...#.#..#..#..#
##..#.###..#.#.
##.............
##..#.########.
..#.##..####..#
..#.##..####..#
##..#.########.
##.............
##..#.###..#.#.

####.##
###..##
#.#####
##..#..
#......
####.##
#.#....
..###..
..#####
#.#....
####.##
#......
##..#..
#.#####
###..##
####.##
#####..

###.##.....
##.##..#..#
##.##.....#
###.##.....
#####...#..
..#########
########.##
##.###...##
..#..#..#.#
..##...##..
...####.#.#

#.##...#....#
##....##....#
##..##..#..#.
##..##..#..#.
##.....#....#
#.##...#....#
.##.....####.
#####..#.##.#
#.####.#.##.#
.#.##.#.#..#.
#...#.#..##..
###..##.####.
.#####.......

#..##.#
#.###..
#.###..
#..##.#
.##.##.
...#...
#..###.
#..##..
#..#..#
#..#..#
#..##..
#..###.
.#.#...

.###.##
.##.###
##.....
##..#..
.##.###
.###.##
#...###

..##..#.##.
.#..#.....#
.#..#.##.#.
######.####
..##.......
..##.......
######.####
.#..#.##.#.
.#..#.....#
..##..#.##.
#........#.
########..#
##..##..##.

..######.....#...
...........##.##.
.#.####.#....####
.#..##..#.####..#
####..#####......
###########.#.##.
.#..##..#..###..#
###.##.###...####
#..####..##.#####

###.#####..##..
...........##..
.#.##...#..##..
.#...##.##....#
.....#.###.##.#
..#####..#....#
##..###..##..##
####.##...#..#.
.#.##..##.#..#.
.####...##.##.#
...#.##..######
..#..##..######
..#..###..####.
..#..###..####.
..#..##..######
.#.#.##..######
.####...##.##.#

..##.##..#.....
..##.##..#.....
.##...##.##...#
.....##..##.##.
#####.####..##.
.#......#.##..#
....##..###.##.

#..####
##.##..
..#.#..
..#.#.#
..#...#
.....#.
.#.#...
.#.#...
.....#.
..#...#
..#.#.#

#.###.#
#####.#
.##..#.
.##..#.
#####.#
#.###.#
...####
.#.##.#
......#

#.##..##.####.#
..######..##..#
###....###..###
...####...##...
#........####..
###.######..###
##.####.##..##.
##..##..######.
.#......#.##.#.
#.#....#.####.#
##......######.
..#....#..##..#
###.##.########
.#......#.##.#.
.#......#....#.

.##........#.
...#.##.##..#
.#..###..####
...#.....####
.#....##..###
#..#...#.#...
#.#...#.##.#.
#.#...#.##.#.
#..#...#.#...
##....##..###
...#.....####
.#..###..####
...#.##.##..#
.##........#.
.##........#.
...#.##.##..#
.#..###..####

....##....###
.########....
##.#..#..####
#...##...##..
#........#.##
###.##.####..
..##..##..###
..#....#.....
#..####..####
##.####.##.##
##..##..##.##

########.#.#.##.#
###..####.##....#
##....##...##..##
#......#.########
#.####.##.##.##.#
#......##.#.#....
#......##....##..
.######.##.......
##....####.#.##.#
#..##..#.###....#
...##...#....##..
.######....######
##.##.##.#...##..
#..##..#.#.##..##
.#....#.##...##..

###.#...####...#.
#..#.##..##..##.#
.##...##....##...
#####......#...##
#####......#...##
.##...##....##...
#..#.##..##..##.#

####..#.##.#.
.#..##.####.#
#..#.#.####.#
#..#.#.####.#
.#..##.####.#
####..#.##.#.
.###.#.####.#
##....#......
####.#..##..#
##..#...##...
...##.#....#.
##.##########
###.####..###

#..######..#...
.###....###..##
.#.####.#.#..##
.###.##.###..##
..###..###..###
.#...##...#..##
###.#..#.###...
#.#.#..#.#.##..
#..######..##..
...#.##.#...###
..#......#.....

......##.#.
##.#..#....
##.#..#....
......##.#.
#.#.#.##.#.
..#.#.###.#
#####..##..
##.###.#..#
..#.##...#.

##......###.###
##......###.###
#.##..##.##..#.
.##....##.###.#
..........#.#.#
..######...#..#
##.####.##...#.
..#....#..##..#
.###..###..##.#
.#......#.##.#.
.#......#.##..#
.#.####.#..#..#
###.##.######..
##..##..#.#....
.##.##.##...##.

.#....#.#..#.
...##....##..
##.##.##....#
#.#..#.#.##.#
.######..##..
###..####..##
##.##.###..##
..#..#..#..#.
.#.####.#..#.
.#....#......
#..##..##..##
.#....#..##..
###..###....#

##.##.##.###....#
.######.####....#
#......##.##.#..#
..#..#..##.##..##
.#....#..#.#.##.#
#..##..#..#######
..#..#...##.#..#.
...##.....#######
#.####.#.#.##..##
##....#######..##
.######..##.#..#.
.##..##..#..#..#.
###..####...#..#.
.#.##.#..#.#....#
.######.#.###..##
.........####..##
##.##.##.........

....##.##.#.#..##
####.##.###.####.
#..##..#.####..##
.##....##.#.##.##
#..#...#.#.##....
.##......##..#.##
#..#.##...#.#.#..

....##.##
....##.##
....#....
..###.#..
##.#.####
....#.#..
..#......
###....#.
#...#.#.#

.....##...###.#.#
.##.#.##.....#...
.##.#.##.....#...
.....##...###.#.#
#.######...###...
..#.#....#.##.#.#
##########.#..#.#
..#..#....###..#.
...##.#.##..###..
#####.#.......##.
..#..#.#.#...##.#
..#..#.#.#...##.#
#####.#...#...##.
...##.#.##..###..
..#..#....###..#.

.#.##.#.....#....
#.#..#.#.#.##.#.#
###..####......##
#.####.#..#..#..#
..#..#..###..###.
..####.....##....
##....####....###

##..#.##......#
..#.##.#.##.###
#..#......#.###
.##.##.#.....#.
#.#..##.##.##.#
#.#..##.##.##.#
.##.##.#.....#.
#..#......#.###
#.#.##.#.##.###
##..#.##......#
#....###.##.#..
#....###.##.#..
##..#.##......#
#.#.##.#.##.###
#..#......#.###

..##.#...#.##
.#.##.#..#...
#..##..##..##
#......###...
...........##
.#.##.#.###..
#.#..#.###...
.#.##.#.##.##
##....##.####
.#.##.#....##
##.##.##..#..
#.####.#.####
#.####.#.#.##
.#....#.##.##
..#..#..##.##
#..##..##....
#......#.#.##

..#..###.....
.##.#.#...#.#
..######.#.#.
...#####.#.#.
.##.#.#...#.#
..#..###.....
#..#######...
.#..#.#......
..####.#..#..
...#..##.####
.####.......#
#...#.##..#.#
...####.##.##
...####.##.##
#...#.##..#.#

...###.
.#..###
.#..###
...###.
..#.#..
.###..#
..#.#.#
.#.#.#.
.###..#
.###..#
.#.#.#.
#.#.#.#
.###..#
..#.#..
...###.

..######.....
##########..#
...####......
#.######.#..#
#..#..#..#..#
#.##.###.#..#
##..##..##..#
##.####.##..#
##.####.#####
#.#.##.#.#..#
.#..##..#.##.
#...##...####
..######.....
##.####.##..#
..........##.

##.##.###.#......
#..##..#.#..####.
#......###.#....#
#########.##....#
...##.....#######
#..##..#..#......
#......####.#..#.
#..##..#..#......
.##..##.#..#.##.#
..#..#...#.##..##
...##....#####.##
##########.#....#
##.##.#####..##..
#.####.######..##
###..#######.##.#
#......#..#.#..#.
..#..#......####.

.#..##.##..###.
.#.###.##..###.
#...#...#####..
...##.####...##
....#.#####.#.#
##.#..#.###.#..
.#.##.####..##.
##.#...##.##.#.
....######.####
....#.#.##..###
..##...#......#
#####...####.##
#####...####.##
..##...#......#
....#.#.##..###
....######.####
##.#...##.##.#.

#..##.###
.##.....#
.##.##..#
###..####
#####.#.#
......#.#
#..##.#..
#..##.#..
......#.#
#####.#.#
###..####
.##.##..#
.##.....#
#..##.###
#..######

..#.#.#..#.#.
..#.#.#..#.#.
#...#.#..#.#.
.###.#..#..#.
.#.#..#.#.#..
#.....#...###
##.##.#####..
##.##.#####..
#.....#...###
.#.##.#.#.#..
.###.#..#..#.

####...#.#.
####...#.#.
#..#..#..##
.....#..###
#..#.#..###
.........#.
.....###.##
######.#...
#..##.###.#
.........#.
..#..#.#.#.
#######.##.
####.#..#.#

#..###.
#..###.
.....##
##.#...
#.#.#..
.###.#.
#.##.##
##..##.
..###.#
...###.
.#.###.

############...##
##..####..##.#...
##..####..##.##..
.####..####..#.##
..##....##..##.#.
.####..####.#..#.
..............##.
#..........#.##.#
##############.#.
.#..#..#..#.#.#.#
............#.#.#
..##....##..###..
#....##....#.###.
##############.##
.#..#..#..#.#...#

.##......#.####
....###..###.##
.....######....
....#..##.##...
######....#.###
#..###.##....#.
########.#.###.
#..#####.#..###
.##..#...####..
.##....##..####
#...##.##.###..
.##...#..######
#..#.#.#.#.#...
.##...#..#....#
.##...#..#....#

##.#.##.#.###
.#.##..##.#.#
#.#..##..#.#.
###.#..#####.
#.#.#..#.#.#.
##.######.###
#.##....##.#.
#.##....##.#.
##.######.###

###..#####.##
###..#####.##
.....###..###
...##..###...
##.#.##.##.##
..##.....#.##
#.###........
#...##...##.#
#.####.##.#..
#.#..###.####
.#.#.#####...
#.##.##.##...
####...####..
#####....####
.#.##.##.#...
.##.##..##...
.#.#...##.#..

.###..###
.#.#....#
.#..##..#
.#......#
...#..#..
##..##..#
####..###
##.#..#.#
#.##..##.
#.##..##.
##.#..#.#
####..###
##..##..#

###...#....
...##.#.#.#
..#########
..##....#.#
..#######.#
..#....##..
..#....###.
..#######.#
..##....#.#

####......#...###
#.#..#..##..#..#.
##.##..####..##.#
..###...##...###.
.######....######
..#####....#####.
#.###...##...###.
.#......##......#
...#..######..#..
...#..######..#..
.#......##......#

...#..#.###
##.####....
...##..####
###...#....
..#..#...##
##..#.##...
...##...##.
.......####
####..###.#
.....#.#..#
##....#....
#######.###
##.####.###

#.#..#...
..##..#..
..##..#..
#.#..#...
.####....
##..#.###
...##....
...#...##
..#..####
.#.##...#
....#....

..#####.....##.
#.##..#....##..
........####..#
......#.###..##
....###....##.#
....###....##.#
......#.###..##
........####..#
#.##..#....##..
..#####.....##.
.##.#..#.#.#.##
.##.#....#.#.##
..#####.....##.

.#.#.#.##
.#.###.##
.##...#..
##.##.##.
##.#..#..
..#..#.#.
##.#.#.##
##.#.#.##
..#..#.#.

..#.#####
##...#..#
##.###..#
######..#
##...#..#
..#.#####
.#.#.....
#.....##.
...#.####
####.####
##.......
#..#.#..#
...##.##.
#.#.##..#
###......
....#####
..##..##.

...##...#
...######
...##....
###..#.##
##.#.#.##
.#...#.#.
..#.#.###
.....##..
###.#....
##.#.#.#.
##.#.#.#.

....#.....#..
#..##.#....#.
##...........
..##.##...##.
.###..#..###.
##.########.#
##..###....##
###.##..#.##.
###.##..#.##.
##..###....##
##.########.#
.###.....###.
..##.##...##.
##...........
#..##.#....#.
....#.....#..
....#.....#..

..##.#.#.
#####.#..
#...####.
##.###...
##....#.#
##.#.#...
...#####.
##..#...#
.....###.
###..##.#
###.#.###
###.#.###
###..##.#

..#.###
.....#.
..#...#
..#..##
####.##
###.#.#
###.#..
####.##
..#..##
..#...#
.....#.

.###.#.#.##.#..
#.####..##..#.#
#.####..##..#.#
.###.#.#.#..#..
....#...#..##.#
..####.##.#...#
##..#.#..#..##.
###..#...#.....
###..#...#.....

#...#.....##.
#.###.#..####
..###.######.
.#..####..##.
.#..####..##.
..###.######.
#.###.#..####
#.........##.
.##.##.###...
#.##..#####..
##..######..#
###.#...#....
.#.#.########
###......###.
....######.#.
.###.##.##.#.
.###.##.##.#.

#..#..#....#..#
..###.#.##.#.##
##.###......###
##...########..
.....#.........
#...###....###.
#...###....###.

.#..#....#..#..
#....#..#####..
.####.###..##..
#....#####.##..
..##.......#.##
.......#.##..##
##..###..###...
.###....#.#.#..
.#..#...##.....
#....#..##.####
##..###.####.##
..##..#...#.#..
.........#..###

.####..
#...#.#
..##..#
#..###.
#..###.
#.##..#
#...#.#
.####..
..##.##
..##...
#....#.
#.#..#.
#.#..#.

#####...#..##
#.###...#..##
.#####.#.#...
.##.##..#####
....##.###...
..#.#.###.###
.##....##..##
##..#.###.###
##...###.#...
.#.##.#.#..##
.#.#...#.####
#....#...#...
...##..##..##

.....#.#.....
....##.......
#..#.#.##....
#####.##.....
#....####.##.
#..####...##.
#..###.#..##.
....##..#####
#####.###....
....#.###....
####.#...#..#
#######......
....#.##.####
.##....#.#..#
....###.##..#

##.####......##.#
....#.###.#...##.
....#.###.#...##.
##.####......##.#
.##..#.##...#.###
.#.#.#...#...#...
#.##.#..##.#.#.#.
#.##.#.###.#.#.#.
.#.#.#...#...#...

#####..####..####
...###..##..###..
..##..........##.
##.#..##..##..#.#
##....#.##.#....#
##.#.#..###.#.#.#
..#.###....###.#.
..##..........##.
..###...##...###.
....#.##..##.#...
.....#......#....

.####..#..#..##
..##...#..#....
......###...###
......##.##..#.
#....#.#.#.#...
######.###...##
.####.#.#..##.#
.......#.#..#..
.......#.#..#..
.####.#.#..##.#
######.###...##
#....#.#.#.#...
......##.##.##.

#.#..##.#.#..
.#..##..#..##
.#..##..#..##
#.#..##.#.#..
..#..#...#.#.
.#...#.#.###.
#.#####.#.##.
#...#...#.#..
#...#...#.#..
#.#####.#.##.
.#...#.#.###.
..#..#...#.#.
#.#..##.#.##.

#..##......##..#.
#..##......##..#.
.#.#.#.##.#.#.#.#
#..#.######.#..##
.#..##.##.##..#.#
#...#..##..#...#.
#.############.#.
#..##.#..#.##..##
#..###....###..##
##.#...##..##.###
.##.##....##.##..

..###.#.##.#.###.
.##.##..##..##.##
.##.##..##..##.##
..###.#.##.#.###.
.##..#.####.#..##
###.##..##..##.##
###.#.#.##.#.#.##
.#..............#
#...###.##.###.#.
###...#....#...##
.##..#..##..#..##
..#..##....##..#.
..#.#.######.#.#.
###..##.##.##..##
..#..#.#..#.#..#.

###.##.##
##..##..#
#.######.
#.######.
##..##..#
###.##.##
.###..###
#.#....#.
..#.##.##

....#.##..#
......#.##.
#.####.#..#
#.####.#..#
......#.##.
....#.##..#
.#.##.#..#.
.##..##....
#....##.##.

.##...##.#.
.#.##...##.
#..#####.##
#..#####.##
.#.##...##.
.##...##.#.
.#..###...#
###.##.##.#
#...##.#.##
#...##.#.##
.##.##.##.#
.#..###...#
.##...##.#.

.##...##.
.##...##.
##..###.#
##.#.#..#
.....#...
#..#.##.#
........#
..##.###.
..##.###.
........#
#..#.##.#
.#...#...
##.#.#..#
##..###.#
.##...##.

####..#..##.##.##
....#.##.........
....#...#.######.
.....##..##....##
.....####........
####..#...##..##.
....###.##.#..#.#
#####.....##..##.
.##.....#...##...
.##.##.#..######.
#..#####..#.##.#.
#..######.##..##.
..#.#.#.#.######.
.##...#..##.##.##
####..####.####.#

#...#.#
#..#.##
##..###
##..##.
#..#.##
#...#.#
.#....#
#..##.#
...#.#.
###...#
##..###
.#####.
.#####.
##..###
###...#

##.##..##.##.#..#
.##..##..#..##..#
#############...#
....#..#........#
#..##..##..#.##..
#..#....#..######
#....##....###.##
###.####.#####..#
.#..####..#.#.###
##..#..#..###..#.
..##.##.##...##.#
.##..##..##.....#
...............#.
...............#.
.##..##..##.....#
..##.##.##...##.#
##..#..#..###..#.

#.#######
##.#...##
#..##..##
#..#.##..
##.##..##
###.#####
###.#####
##.##..##
#..#.##..
#..##..##
##.#...##
#.#######
..#.#.#..
#...#.##.
.#.#..#..
.#.##..##
#.#..####

.......#.#...####
....#..#....#.##.
..##...#...######
##.#....#.##.####
##..##...#####..#
.##...#####.#####
.####..##.#...##.
#..#..#####..#..#
#..#..#####..#..#
.####..##.#...##.
.##...#####.#####
##..###..#####..#
##.#....#.##.####
..##...#...######
....#..#....#.##.`.split("\n\n");

//--------------- Function section ----------------------//

const getPatterns = function (patterns: string[]): string[][] {
  let patternGrids: string[][] = [];

  patterns.forEach((pattern) => {
    const patternGrid: string[] = pattern.split("\n");

    let grid: string[] = Array(patternGrid.length);

    for (let i = 0; i < patternGrid.length; i++) {
      grid[i] = patternGrid[i];
    }

    patternGrids.push(grid);
  });

  return patternGrids;
};

const invertAllPatterns = function (patterns: string[][]): string[][] {
  let invertedPatterns: string[][] = [];

  patterns.forEach((pattern) => {
    invertedPatterns.push(invertPattern(pattern));
  });

  return invertedPatterns;
};

const invertPattern = function (pattern: string[]): string[] {
  let invertedPattern: string[] = [];

  for (let i = 0; i < pattern[0].length; i++) {
    let row: string = "";

    for (let j = 0; j < pattern.length; j++) {
      row += pattern[j][i];
    }

    invertedPattern.push(row);
  }

  return invertedPattern;
};

const checkPattern = function (index: number) {
  const pattern: string[] = allPatterns[index];
  const invertedPattern: string[] = allInvertedPatterns[index];

  // Check horizontal line of reflection
  for (let i = 0; i < pattern.length - 1; i++) {
    if (pattern[i] === pattern[i + 1]) {
      let reflecting = true;
      let leftIndex = i - 1;
      let rightIndex = i + 2;

      while (reflecting && leftIndex >= 0 && rightIndex < pattern.length) {
        if (pattern[leftIndex] === pattern[rightIndex]) {
          leftIndex--;
          rightIndex++;
        } else {
          reflecting = false;
        }
      }

      if (reflecting) {
        console.log(
          `Found horizontal match on pattern ${index + 1} on line ${i + 1}`
        );
        horizontalMatches.push(i + 1);
        verticalMatches.push(0);
      }
    }
  }

  // Check vertical line of reflection
  for (let i = 0; i < invertedPattern.length - 1; i++) {
    if (invertedPattern[i] === invertedPattern[i + 1]) {
      let reflecting = true;
      let leftIndex = i - 1;
      let rightIndex = i + 2;

      while (
        reflecting &&
        leftIndex >= 0 &&
        rightIndex < invertedPattern.length
      ) {
        if (invertedPattern[leftIndex] === invertedPattern[rightIndex]) {
          leftIndex--;
          rightIndex++;
        } else {
          reflecting = false;
        }
      }

      if (reflecting) {
        console.log(
          `Found vertical match on pattern ${index + 1} on line ${i + 1}`
        );
        verticalMatches.push(i + 1);
        horizontalMatches.push(0);
      }
    }
  }
};

const flipCharacter = function (
  index: number,
  row: number,
  column: number
): string[] {
  let pattern: string[] = allPatterns[index];

  let newStr: string[] = [...pattern[row]];
  newStr[column] == "." ? (newStr[column] = "#") : (newStr[column] = ".");
  pattern[row] = newStr.join("");

  return pattern;
};

const checkCleanPattern = function (pattern: string[]): [number, number] {
  const invertedPattern: string[] = invertPattern(pattern);
  let horizontalMatch: number = 0;
  let verticalMatch: number = 0;

  // Check horizontal line of reflection
  for (let i = 0; i < pattern.length - 1; i++) {
    if (pattern[i] === pattern[i + 1]) {
      let reflecting = true;
      let leftIndex = i - 1;
      let rightIndex = i + 2;

      while (reflecting && leftIndex >= 0 && rightIndex < pattern.length) {
        if (pattern[leftIndex] === pattern[rightIndex]) {
          leftIndex--;
          rightIndex++;
        } else {
          reflecting = false;
        }
      }

      if (reflecting) {
        horizontalMatch = i + 1;
      }
    }
  }

  // Check vertical line of reflection
  for (let i = 0; i < invertedPattern.length - 1; i++) {
    if (invertedPattern[i] === invertedPattern[i + 1]) {
      let reflecting = true;
      let leftIndex = i - 1;
      let rightIndex = i + 2;

      while (
        reflecting &&
        leftIndex >= 0 &&
        rightIndex < invertedPattern.length
      ) {
        if (invertedPattern[leftIndex] === invertedPattern[rightIndex]) {
          leftIndex--;
          rightIndex++;
        } else {
          reflecting = false;
        }
      }

      if (reflecting) {
        verticalMatch = i + 1;
      }
    }
  }

  return [horizontalMatch, verticalMatch];
};

const checkAllPatterns = function () {
  for (let i = 0; i < allPatterns.length; i++) {
    checkPattern(i);
  }
};

const checkAllCleanPatterns = function () {
  for (let i = 0; i < allPatterns.length; i++) {
    for (let j = 0; j < allPatterns[0].length; j++) {
      for (let k = 0; k < allPatterns[0][0].length; k++) {
        const newPattern = flipCharacter(i, j, k);
        const [hor, ver] = checkCleanPattern(newPattern);
        if (hor > 0) {
          console.log(
            `For pattern ${i}, the match is changing to horizontal at ${hor}`
          );
          horizontalMatches[i] = hor;
          verticalMatches[i] = 0;
        } else if (ver > 0) {
          console.log(
            `For pattern ${j}, the match is changing to vertical at ${hor}`
          );
          verticalMatches[i] = ver;
          horizontalMatches[i] = 0;
        }
      }
    }
  }
};

const getAnswer = function (): number {
  const verticalScore: number = verticalMatches.reduce((a, b) => a + b);
  const horizontalScore: number =
    horizontalMatches.reduce((a, b) => a + b) * 100;
  const answer: number = verticalScore + horizontalScore;

  return answer;
};

//--------------- Answer section ----------------------//
const input: string[] = testInput;
const allPatterns: string[][] = getPatterns(input);
const allInvertedPatterns: string[][] = invertAllPatterns(allPatterns);

let horizontalMatches: number[] = [];
let verticalMatches: number[] = [];

checkAllPatterns();
checkAllCleanPatterns();
console.log(getAnswer());
